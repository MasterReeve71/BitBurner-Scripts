export async function main(ns) {
  await ns.disableLog('ALL');

  const server_list = [ns.args[0], ns.args[1], ns.args[2], ns.args[3]];
  var hacking = false;

  while (true) {
    for (var i = 0; i < 4; i++) {
      const target = server_list[i];
      if (ns.hasRootAccess(target)) {
        const targetCash = await ns.getServerMaxMoney(target) * 0.85;
        const targetSec = await ns.getServerMinSecurityLevel(target) * 1.25;
        const mySkill = await ns.getHackingLevel();
        const security = await ns.getServerSecurityLevel(target);
        const money = await ns.getServerMoneyAvailable(target);
        const level = await ns.getServerRequiredHackingLevel(target);
        if (!hacking) {
          if (mySkill >= level) {
            hacking = true;
            await ns.toast('hack(' + target + '): STARTED', 'info', 5000);
          }
        }
        if (mySkill >= level) {
          if (security > targetSec) { await ns.weaken(target); }
          else if (money < targetCash) { await ns.grow(target); }
          else {
            const earnings = await ns.hack(target);
            if (earnings > await ns.getServerMoneyAvailable('home') * 0.05) {
              await ns.toast('hack('+target+'): '+await ns.nFormat(earnings,'$0a'),'success',2000);
            }
          }
        }
      }
      await ns.sleep(500);
    }
  }
}